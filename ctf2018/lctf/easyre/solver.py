from numpy import*
from Crypto.Cipher import DES

subscript1=[0,1,14,12,17,18,19,27,28,2,15,20,31,29,30,16,13,5]
subscript2=[19,18,5,7,17,1,0,20,6,29,28,27,15,16,4,3,2,32]
A=[[0x17,0x41,0x18,0x4E,0x2B,0x38],[0x3B,0x43,0x15,0x2B,0x2D,0x4C],[0x17,0x36,0x4C,0x0C,0x41,0x2B],[0x59,0x28,0x20,0x43,0x49,0x39],[0x17,0x2D,0x1F,0x36,0x1F,0x34],[0x0D,0x18,0x36,0x41,0x22,0x18]]
B=[[0x0AA92,0x0C006,0x0A815,0x0C920,0x0D095,0x0CAD1],[0x7004,0x9B3C,0x68A1,0x0A2C1,0x8B5B,0x9EB5],[0x7E37,0x7AA2,0x4F95,0x0A344,0x82AC,0x8C00],[0x432B,0x71F7,0x732D,0x6E76,0x70A1,0x6F34],[0x0B465,0x0E401,0x0AF37,0x0DAD2,0x0DF89,0x0ECFA],[0x657D,0x6838,0x5FCE,0x977C,0x71F4,0x759E]]
cipher1=''
cipher2=[0x7C,0x81,0x61,0x99,0x67,0x9B,0x14,0xEA,0x68,0x87,0x10,0xEC,0x16,0xF9,0x07,0xF2,0x0F,0xF3,0x03,0xF4,0x33,0xCF,0x27,0xC6,0x26,0xC3,0x3D,0xD0,0x2C,0xD2,0x23,0xDE,0x28,0xD1,0x01,0xE6]

mA=matrix(A)
mB=matrix(B)
mX=mB*mA.I
X=matrix.tolist(mX)
for i in range(6):
    for j in range(6):
        X[i][j]=int(round(X[i][j]))
        cipher1+=hex(X[i][j])[2:].zfill(2)
cipher1+='733CF57C'
cipher1=cipher1.decode('hex')
key='fa1conn\x00'
des = DES.new(key)
plain1=des.decrypt(cipher1)
print(plain1)

plain2=''
for i in range(36):
    for j in [0,2,4,6]:
        cipher2[i] ^= 1 << (j + i % 2)
    plain2+=chr(cipher2[i])

flag=''
for i in range(len(subscript1)):
    flag+=plain1[subscript1[i]]
print(flag)
for i in range(18):
    flag+=plain2[subscript2[i]]
print(flag)
